(()=>{"use strict";const e=(e,t)=>{const a=t.split("."),r=(e,t)=>{if(!e||0===t.length)return;const a=t[0],s=t.slice(1),o=a.endsWith("[]"),i=o?a.slice(0,-2):a;if(o){const t=e?.[i];Array.isArray(t)&&t.forEach(e=>r(e,s))}else 0===s.length?e?.[i]&&e[i]in window.statisticsForStrava.callbacks&&(e[i]=window.statisticsForStrava.callbacks[e[i]]):r(e?.[i],s)};r(e,a)};class t{constructor(e,t){this.wrapper=e,this.storage=t,this.filters={}}prefillFromStorage(e){const t=this.storage.get(e);if(!t)return;Object.keys(t).forEach(e=>{if(e.includes("."))return;const a=t[e];this.wrapper.querySelectorAll(`input[data-dataTable-filter="${e}"]`).forEach(e=>{e.value.toLowerCase()===a.toLowerCase()&&(e.checked=!0)})});const a={};Object.keys(t).filter(e=>e.includes(".")).forEach(e=>{const[r,s]=e.split(".");a[r]||(a[r]={}),a[r][s]=t[e]}),Object.keys(a).forEach(e=>{const t=a[e],r=this.wrapper.querySelector(`input[name="${e}[from]"]`),s=this.wrapper.querySelector(`input[name="${e}[to]"]`);r&&t.from&&(r.value=t.from),s&&t.to&&(s.value=t.to)}),this.storage.clearAll()}getActiveFilters(){const e={};return this.wrapper.querySelectorAll("[data-dataTable-filter]:checked").forEach(t=>{const a=t.getAttribute("data-dataTable-filter");e[a]=t.value.toLowerCase()}),this.wrapper.querySelectorAll('[data-dataTable-filter*="[]"]').forEach(t=>{const a=t.getAttribute("data-dataTable-filter").replace("[]",""),r=t.querySelector(`input[name="${a}[from]"]`),s=t.querySelector(`input[name="${a}[to]"]`);if(r&&s&&r.valueAsDate&&s.valueAsDate){const t=new Date(r.valueAsDate).setHours(0,0,0),o=new Date(s.valueAsDate).setHours(23,59,59);e[a]=[t,o]}}),e}updateDropdownState(e){this.wrapper.querySelectorAll(".filter-dropdown [data-dropdown-toggle]").forEach(e=>{e.classList.remove("active")}),Object.keys(e).forEach(t=>{const a=e[t];if(Array.isArray(a)){const e=this.wrapper.querySelector(`[data-datatable-filter="${t}[]"]`)?.closest(".filter-dropdown")?.querySelector("[data-dropdown-toggle]");return void(e&&e.classList.add("active"))}const r=this.wrapper.querySelector(`[data-dataTable-filter="${t}"]:checked`),s=r?.closest(".filter-dropdown")?.querySelector("[data-dropdown-toggle]");s&&s.classList.add("active")})}applyFiltersToRows(e,t=""){const a=this.getActiveFilters(),r=t.toLowerCase();return e.forEach(e=>{e.active=!e.searchables||e.searchables.toLowerCase().includes(r);for(const[t,r]of Object.entries(a))if(Array.isArray(r)){const a=e.filterables[t];e.active=e.active&&a>=r[0]&&a<=r[1]}else{const a=e.filterables[t]?.toLowerCase();e.active=e.active&&a===r}}),e}}class a{static calculate(e){return e.filter(e=>e.active).reduce((e,t)=>(Object.entries(t.summables).forEach(([t,a])=>e[t]=(e[t]||0)+a),e),{})}static render(e,t){const a=this.calculate(t);e.querySelectorAll("[data-dataTable-summable]").forEach(e=>{const t=e.getAttribute("data-dataTable-summable");e.innerHTML=void 0!==a[t]?(e=>{e=(e+"").replace(/[^0-9+\-Ee.]/g,"");const t=isFinite(+e)?+e:0,a=isFinite(0)?Math.abs(0):0;let r="";return r=(a?function(e,t){if(-1===(""+e).indexOf("e"))return+(Math.round(e+"e+"+t)+"e-"+t);{const a=(""+e).split("e");let r="";return+a[1]+t>0&&(r="+"),(+(Math.round(+a[0]+"e"+r+(+a[1]+t))+"e-"+t)).toFixed(t)}}(t,a).toString():""+Math.round(t)).split("."),r[0].length>3&&(r[0]=r[0].replace(/\B(?=(?:\d{3})+(?!\d))/g," ")),(r[1]||"").length<a&&(r[1]=r[1]||"",r[1]+=new Array(a-r[1].length+1).join("0")),r.join(",")})(a[t]):0})}}class r{constructor(e){this.columns=e,this.sortAsc=!1,this.sortOnPrevious=null}attachListeners(e,t,a){this.columns.forEach(r=>r.addEventListener("click",()=>{const s=r.getAttribute("data-dataTable-sort");s===this.sortOnPrevious?this.sortAsc=!this.sortAsc:this.sortAsc=!0,this.sortOnPrevious=s,this.columns.forEach(e=>e.querySelector(".sorting-icon")?.setAttribute("aria-sort","none")),r.querySelector(".sorting-icon")?.setAttribute("aria-sort",this.sortAsc?"ascending":"descending"),e.sort((e,t)=>{const a=e.sort[s],r=t.sort[s];return void 0===a?1:void 0===r?-1:a<r?this.sortAsc?-1:1:a>r?this.sortAsc?1:-1:0}),t.update(e.filter(e=>e.active).map(e=>e.markup)),a.scrollTop=0}))}}class s{constructor(e,t,a){this.wrapper=e,this.tbody=t,this.scrollElem=a,this.cluster=null}init(e){this.cluster=new Clusterize({rows:e.filter(e=>e.active).map(e=>e.markup),scrollElem:this.scrollElem,contentElem:this.tbody,no_data_class:"clusterize-loading",callbacks:{clusterChanged:()=>{a.render(this.wrapper,e);const t=this.wrapper.querySelector("[data-dataTable-result-count]");t&&(t.innerText=e.filter(e=>e.active).length)}}})}update(e){this.cluster&&(this.cluster.update(e.filter(e=>e.active).map(e=>e.markup)),this.scrollElem.scrollTop=0)}}class o{constructor(e="dataTableFilters"){this.storageKey=e}clearAll(){localStorage.removeItem(this.storageKey)}get(e){const t=localStorage.getItem(this.storageKey);return t&&JSON.parse(t)[e]||{}}set(e){localStorage.setItem(this.storageKey,JSON.stringify(e))}}class i{constructor(e){this.wrapper=e,this.table=e.querySelector("table"),this.tbody=this.table?.querySelector("tbody"),this.scrollElem=e.querySelector(".scroll-area"),this.searchInput=e.querySelector('input[type="search"]'),this.resetBtn=e.querySelector("[data-dataTable-reset]"),this.settings=JSON.parse(e.getAttribute("data-dataTable-settings")),this.storage=new o,this.filterManager=new t(e,this.storage),this.clusterRenderer=new s(e,this.tbody,this.scrollElem),this.sorter=new r(e.querySelectorAll("thead th[data-dataTable-sort]"))}async render(){this.table&&this.tbody&&this.searchInput&&(this.wrapper.querySelectorAll('input[type="date"][data-default-to-today]').forEach(e=>e.valueAsDate=new Date),fetch(this.settings.url,{cache:"no-store"}).then(async e=>{const t=await e.json();this.clusterRenderer.init(t);const a=()=>{const e=this.searchInput.value.trim(),a=this.filterManager.getActiveFilters();this.filterManager.updateDropdownState(a);const r=this.filterManager.applyFiltersToRows(t,e);this.clusterRenderer.update(r),this.resetBtn.classList.toggle("hidden",!(Object.keys(a).length>0||e.length>0))};this.filterManager.prefillFromStorage(this.settings.name),a(),this.searchInput.addEventListener("input",((e,t=300)=>{let a;return(...r)=>{clearTimeout(a),a=setTimeout(()=>{e.apply(void 0,r)},t)}})(a)),this.wrapper.querySelectorAll("[data-dataTable-filter]").forEach(e=>e.addEventListener("input",a)),this.sorter.attachListeners(t,this.clusterRenderer.cluster,this.scrollElem),this.resetBtn&&this.resetBtn.addEventListener("click",e=>{e.preventDefault(),location.reload()}),this.wrapper.querySelectorAll("[data-datatable-filter-clear]").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault();const r=e.getAttribute("data-datatable-filter-clear");this.wrapper.querySelectorAll(`[name^="${r}"]`).forEach(e=>{"radio"===e.type||"checkbox"===e.type?e.checked=!1:e.value=""}),a()})})}))}}class l{constructor(e,t){this.wrapper=e,this.config=t,this.placesControl=null,this.mainFeatureGroup=L.featureGroup(),this.map=L.map(this.wrapper,{scrollWheelZoom:!0,minZoom:1,maxZoom:21}),this.config.tileLayerUrls.forEach(e=>{L.tileLayer(e).addTo(this.map)})}redraw(e){e=e.filter(e=>e.active),this.mainFeatureGroup.clearLayers(),this.placesControl&&this.map.removeControl(this.placesControl);const t=[],a=new Map,r=L.featureGroup(),s=(e=>{const t=e.reduce((e,t)=>{const a=t.location.state;return a&&(e[a]=(e[a]||0)+1),e},{});return Object.keys(t).reduce((e,a)=>t[e]>t[a]?e:a,"")||null})(e);e.forEach(e=>{const{countryCode:t,state:o}=e.location;a.has(t)||a.set(t,L.featureGroup());const i=L.Polyline.fromEncoded(e.encodedPolyline).getLatLngs();L.polyline(i,{color:this.config.polylineColor,weight:1.5,opacity:.5,smoothFactor:1,overrideExisting:!0,detectColors:!0}).addTo(a.get(t)),s===o&&L.polyline(i).addTo(r)}),a.forEach((e,a)=>{e.addTo(this.mainFeatureGroup),t.push({countryCode:a,bounds:e.getBounds()})}),this.mainFeatureGroup.addTo(this.map),this.placesControl=L.control.flyToPlaces({places:t}),this.placesControl.addTo(this.map),r.getBounds().isValid()&&this.map.fitBounds(r.getBounds())}}class n{constructor(e){this.wrapper=e,this.heatmap=e.querySelector("[data-leaflet-routes]"),this.resetBtn=e.querySelector("[data-dataTable-reset]"),this.config=JSON.parse(this.heatmap.getAttribute("data-heatmap-config")),this.filterManager=new t(e,new o),this.drawer=new l(this.heatmap,this.config)}async render(){this.wrapper.querySelectorAll('input[type="date"][data-default-to-today]').forEach(e=>e.valueAsDate=new Date);const e=JSON.parse(this.heatmap.getAttribute("data-leaflet-routes")),t=()=>{const t=this.filterManager.getActiveFilters();this.filterManager.updateDropdownState(t);const a=this.filterManager.applyFiltersToRows(e);this.drawer.redraw(a),this.resetBtn.classList.toggle("hidden",!(Object.keys(t).length>0));const r=this.wrapper.querySelector("[data-dataTable-result-count]");r&&(r.innerText=a.length)};t(),this.wrapper.querySelectorAll("[data-dataTable-filter]").forEach(e=>e.addEventListener("input",t)),this.resetBtn&&this.resetBtn.addEventListener("click",e=>{e.preventDefault(),location.reload()}),this.wrapper.querySelectorAll("[data-datatable-filter-clear]").forEach(e=>{e.addEventListener("click",a=>{a.preventDefault();const r=e.getAttribute("data-datatable-filter-clear");this.wrapper.querySelectorAll(`[name^="${r}"]`).forEach(e=>{"radio"===e.type||"checkbox"===e.type?e.checked=!1:e.value=""}),t()})})}}const c=document.querySelector("main"),d=document.querySelector("aside"),u=document.querySelector("nav");"true"===localStorage.getItem("sideNavCollapsed")&&(c.classList.add("sidebar-is-collapsed"),d.classList.add("sidebar-is-collapsed"),u.classList.add("sidebar-is-collapsed")),document.getElementById("toggle-sidebar-collapsed-state").addEventListener("click",()=>{c.classList.toggle("sidebar-is-collapsed"),d.classList.toggle("sidebar-is-collapsed"),u.classList.toggle("sidebar-is-collapsed"),localStorage.setItem("sideNavCollapsed","false"),c.classList.contains("sidebar-is-collapsed")&&localStorage.setItem("sideNavCollapsed","true")});const h=function(e){const t=e.querySelector("#js-loaded-content"),a=e.querySelector("#spinner"),r=document.querySelector("aside"),s=document.querySelectorAll("nav a[data-router-navigate]:not([data-router-disabled]), aside li a[data-router-navigate]:not([data-router-disabled])"),o=document.querySelector('[data-drawer-target="drawer-navigation"]'),i=e=>{const t=document.querySelector('aside li a[data-router-navigate="'+e+'"]');if(t)return t;const a=e.replace(/\/[^\/]*$/,"");return a===e||""===a?null:i(a)},l=async(l,c)=>{r.hasAttribute("aria-hidden")||o.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),a.classList.remove("hidden"),a.classList.add("flex"),t.classList.add("hidden");const d=await fetch(l+".html",{cache:"no-store"});t.innerHTML=await d.text(),window.scrollTo(0,0),a.classList.remove("flex"),a.classList.add("hidden"),t.classList.remove("hidden"),e.setAttribute("data-router-current",l),e.setAttribute("data-modal-current",c),s.forEach(e=>{e.setAttribute("aria-selected","false")});const u=i(l);u?.setAttribute("aria-selected","true"),u&&u.hasAttribute("data-router-sub-menu")&&u.closest("ul")?.classList.remove("hidden");const h=document.querySelectorAll("main a[data-router-navigate]:not([data-router-disabled])");n(h);const p=l.replace(/^\/+/,"").replaceAll("/","-");document.dispatchEvent(new CustomEvent("pageWasLoaded",{bubbles:!0,cancelable:!1,detail:{page:p,modalId:c}})),document.dispatchEvent(new CustomEvent("pageWasLoaded."+p,{bubbles:!0,cancelable:!1,detail:{page:p,modalId:c}}))},n=e=>{e.forEach(function(e){e.addEventListener("click",t=>{t.preventDefault();const a=e.getAttribute("data-router-navigate");document.dispatchEvent(new CustomEvent("navigationLinkHasBeenClicked",{bubbles:!0,cancelable:!1,detail:{link:e}})),c(a,null)})})},c=(t,a)=>{e.getAttribute("data-router-current")!==t&&(l(t,a),d(t))},d=(e,t)=>{const a=t?e+"#"+t:e;window.history.pushState({route:e,modal:t},"",a)},u=()=>location.pathname.replace("/","")?location.pathname:"/dashboard";return{boot:()=>{if(null===t)return;const e=u(),a=location.hash.replace("#","");n(s),window.onpopstate=function(e){e.state&&l(e.state.route,e.state.modal)},l(e,a),window.history.replaceState({route:e,modal:a},"",e+location.hash)},pushCurrentRouteToHistoryState:e=>{d(u(),e)},navigateTo:c}}(c);h.boot();const p=new o,g=document.getElementById("modal-skeleton"),m=g.querySelector("#modal-content"),f=g.querySelector(".spinner");let y=null,b=[],v=[];document.addEventListener("pageWasLoaded",e=>{y&&y.hide(),document.querySelectorAll("div[data-dataTable-settings]").forEach(function(e){new i(e).render()}),b=[],v=[],S(document),e.detail&&e.detail.modalId&&q(e.detail.modalId)}),document.addEventListener("pageWasLoaded.heatmap",()=>{const e=document.querySelector(".heatmap-wrapper");new n(e).render()}),document.addEventListener("navigationLinkHasBeenClicked",e=>{e.detail&&e.detail.link&&e.detail.link.hasAttribute("data-dataTable-filters")&&p.set(JSON.parse(e.detail.link.getAttribute("data-dataTable-filters")))}),document.addEventListener("dataTableClusterWasChanged",()=>{E(document)}),document.getElementById("toggle-sidebar-collapsed-state").addEventListener("click",()=>{v.forEach(e=>{e.resize()})}),window.addEventListener("resize",function(){v.forEach(e=>{e.resize()})});const w=document.querySelector("a[data-modal-custom-ai]");w&&w.addEventListener("click",e=>{e.preventDefault(),e.stopPropagation();const t=w.getAttribute("data-modal-custom-ai");q(t),h.pushCurrentRouteToHistoryState(t)}),document.addEventListener("modalWasLoaded.ai-chat",e=>{(function(e){const t=e.querySelector(".chat--wrapper"),a=e.querySelector("form"),r=a.querySelector("button.send-message"),s=a.querySelector("input.message"),o=a.querySelector("div.spinner"),i=s.getAttribute("data-placeholder-idle"),l=s.getAttribute("data-placeholder-processing"),n=e=>{s.disabled=e,r.disabled=e,r.classList.toggle("inline-flex",!e),r.classList.toggle("hidden",e),a.classList.toggle("disabled",e),o.classList.toggle("hidden",!e),s.value="",s.placeholder=e?l:i},c=JSON.parse(t.getAttribute("data-chat-commands")||"{}");return{render:()=>{(()=>{if(!c)return;const e=new autoComplete({selector:()=>s,data:{src:Object.keys(c)},threshold:1,trigger:e=>e.startsWith("/"),resultsList:{tabSelect:!0,position:"beforebegin"},resultItem:{highlight:!0,element:(e,t)=>{e.innerHTML=`<div>${t.match}</div><div class="text-xs text-gray-500">${c[t.value]}</div>`}},events:{input:{focus:()=>{e.input.value.length&&e.start()}}}});e.input.addEventListener("selection",function(t){const a=t.detail;e.input.value=c[a.selection.value]||null})})(),a.addEventListener("submit",async e=>{e.preventDefault();const r=new FormData(a);n(!0);const o=new EventSource(`/chat/sse?message=${encodeURIComponent(r.get("form[message]"))}`);o.addEventListener("fullMessage",e=>{t.innerHTML+=e.data.replace(/\\n/g,"\n")}),o.addEventListener("removeThinking",()=>{const e=t.querySelector(".thinking");e&&e.remove()}),o.addEventListener("agentResponse",e=>{t.querySelector("div.message-wrapper:last-child > div.message").innerHTML+=e.data.replace(/\\n/g,"\n")}),o.addEventListener("done",function(){o.close(),n(!1),s.focus()})}),s.addEventListener("keydown",function(e){"Enter"!==e.key||e.shiftKey||(e.preventDefault(),a.requestSubmit())})}}})(e.detail.modal).render()});const S=t=>{lazyLoad.update(),A(t),initPopovers(),initTooltips(),initDropdowns(),initAccordions(),E(t);const a={handleActivityGridChartClick:e=>{!e||!e.value||e.value<1||(p.set({activities:{"start-date.from":e.value[0],"start-date.to":e.value[0]}}),h.navigateTo("/activities"))}},r=[];t.querySelectorAll("[data-echarts-options]").forEach(function(t){const s=echarts.init(t),o=JSON.parse(t.getAttribute("data-echarts-options"));e(o,"tooltip.formatter"),e(o,"tooltip.valueFormatter"),e(o,"yAxis.axisLabel.formatter"),e(o,"yAxis[].axisLabel.formatter"),e(o,"series.symbolSize"),s.setOption(o);const i=t.getAttribute("data-echarts-click");i&&a[i]&&s.on("click",function(e){a[i](e)}),t.hasAttribute("data-echarts-connect")&&r.push(s),v.push(s);const l=t.closest('div[role="tabpanel"]');if(l){const e=l.getAttribute("id");b[e]=b[e]||[],b[e].push(s)}}),echarts.connect(r),t.querySelectorAll("[data-leaflet]").forEach(function(e){const t=JSON.parse(e.getAttribute("data-leaflet"));(function(e,t){return{render:()=>{const a=L.map(e,{scrollWheelZoom:!1,minZoom:t.minZoom,maxZoom:t.maxZoom});t.tileLayer&&L.tileLayer(t.tileLayer).addTo(a);const r=L.featureGroup();if(t.routes.forEach(e=>{L.polyline(L.Polyline.fromEncoded(e).getLatLngs(),{color:"#fc6719",weight:2,opacity:.9,lineJoin:"round"}).addTo(r)}),t.imageOverlay&&(L.imageOverlay(t.imageOverlay,t.bounds,{attribution:'© <a href="https://zwift.com" rel="noreferrer noopener">Zwift</a>'}).addTo(a),a.setMaxBounds(t.bounds)),r.addTo(a),a.fitBounds(r.getBounds(),{maxZoom:t.maxZoom}),!e.hasAttribute("data-leaflet-echart-connect"))return;const s=document.querySelector("div[data-echarts-options][data-leaflet-echart-connect]");if(!s)return;const o=JSON.parse(s.getAttribute("data-leaflet-echart-connect"));if(!o)return;const i=L.circleMarker([0,0],{radius:6,color:"#303030",fillColor:"#F26722",fillOpacity:0,opacity:0}).addTo(a),l=echarts.getInstanceByDom(s),n=a.getZoom();l.on("updateAxisPointer",function(e){e.dataIndex&&e.dataIndex in o?(i.setLatLng(o[e.dataIndex]),i.setStyle({opacity:1,fillOpacity:1}),a.getZoom()>n&&a.panTo(i.getLatLng())):i.setStyle({opacity:0,fillOpacity:0})})}}})(e,t).render()}),t.querySelectorAll("[data-light-gallery-elements]").forEach(function(e){const t=JSON.parse(e.getAttribute("data-light-gallery-elements")),a=lightGallery(e,{dynamic:!0,plugins:[lgZoom],backdropDuration:200,dynamicEl:t});e.addEventListener("click",()=>{a.openGallery()})})},E=e=>{e.querySelectorAll("a[data-model-content-url]").forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation();const a=e.getAttribute("data-model-content-url");q(a),h.pushCurrentRouteToHistoryState(a)})})},A=e=>{e.querySelectorAll("[data-tabs]").forEach(e=>{const t=[];let a=null;e.querySelectorAll('[role="tab"]').forEach(function(e){const r=e.getAttribute("data-tabs-target");t.push({id:r,triggerEl:e,targetEl:document.querySelector(r)}),e.hasAttribute("data-tab-default")&&(a=r)}),new Tabs(e,t,{defaultTabId:a,activeClasses:"text-strava-orange border-strava-orange hover:text-gray-600 hover:border-gray-300",inactiveClasses:"text-gray-500 hover:text-gray-600 border-gray-100 hover:border-gray-300",onShow:(e,t)=>{const a=t.id.replace("#","");a in b&&b[a].forEach(e=>e.resize())}})})},q=e=>{y&&y.hide(),f.classList.remove("hidden"),f.classList.add("flex"),y=new Modal(g,{placement:"bottom",closable:!0,backdropClasses:"bg-gray-900/50 fixed inset-0 z-1400",onShow:async()=>{const t=await fetch(e,{cache:"no-store"});f.classList.add("hidden"),f.classList.remove("flex"),m.innerHTML=await t.text(),S(g),m.querySelector("button.close")&&m.querySelector("button.close").addEventListener("click",e=>{e.preventDefault(),e.stopPropagation(),y.hide(),h.pushCurrentRouteToHistoryState()}),document.body.addEventListener("keydown",e=>{"Escape"===e.key&&h.pushCurrentRouteToHistoryState()},{once:!0}),document.body.addEventListener("click",e=>{"modal-skeleton"===e.target.id&&h.pushCurrentRouteToHistoryState()},{once:!0});const a=e.replace(/^\/+/,"").replaceAll("/","-");document.dispatchEvent(new CustomEvent("modalWasLoaded."+a,{bubbles:!0,cancelable:!1,detail:{modal:g}}))},onHide:()=>{m.innerHTML=""}}),y.show()},T=e=>{const t=document.querySelector("[data-latest-version]"),a=t.querySelector("a");a&&(a.href=a.href.replace("[LATEST_VERSION]",e),a.textContent=a.textContent.replace("[LATEST_VERSION]",e)),t.classList.remove("hidden")};(async()=>{const e=document.querySelector("[data-latest-version]");if(!e)return;const t=e.dataset.currentVersion;if(!t)return;const a="latestReleaseCache",r=Date.now(),s=JSON.parse(localStorage.getItem(a)||"null");if(s&&r-s.timestamp<216e5)((e,t)=>{e=e.replace(/^v/,""),t=t.replace(/^v/,"");const a=e.split(".").map(Number),r=t.split(".").map(Number);for(let e=0;e<Math.max(a.length,r.length);e++){const t=a[e]||0,s=r[e]||0;if(t>s)return 1;if(t<s)return-1}return 0})(t,s.latestVersion)<0&&T(s.latestVersion);else try{const e=await fetch("https://api.github.com/repos/robiningelbrecht/statistics-for-strava/releases/latest",{headers:{Accept:"application/vnd.github+json"}});if(!e.ok)throw new Error("Failed to fetch latest release");const s=(await e.json()).name;if(t===s)return void localStorage.setItem(a,JSON.stringify({latestVersion:s,timestamp:r}));const o=await fetch(`https://api.github.com/repos/robiningelbrecht/statistics-for-strava/actions/runs?event=push&status=completed&conclusion=success&exclude_pull_requests=true&branch=${s}`,{headers:{Accept:"application/vnd.github+json"}});if(!o.ok)throw new Error("Failed to fetch workflow runs");const{workflow_runs:i=[]}=await o.json();if(!i.find(e=>".github/workflows/docker-image.yml"===e.path))return;T(s),localStorage.setItem(a,JSON.stringify({latestVersion:s,timestamp:r}))}catch(e){console.error("Error checking latest release:",e)}})()})();